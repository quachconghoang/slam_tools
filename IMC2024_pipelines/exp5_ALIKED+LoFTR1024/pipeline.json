[
    {
        "task": "get_image_pair_exhaustive",
        "comment": "",
        "params": {
            "input": "",
            "output": "image_pair.csv"
        }
    },

    {
        "task": "rotate_matching_find_best",
        "comment": "aliked_LightGlue (imsize=840)",
        "params": {
            "matcher": "LightGlue",
            "extractor": "aliked",
            "input": {
                "image_pair": "image_pair.csv"
            },
            "output": {
                "keypoints": "keypoints_orig.h5",
                "descriptions": "descriptions_orig.h5",
                "matches": "matches_orig.h5",
                "image_pair_csv": "image_pair.csv"
            },
            "sufficient_matching_num": 512,
            "keypoint_detection_args": {
                "extractor_conf": {
                    "max_num_keypoints": 1024,
                    "detection_threshold": 0.01,
                    "nms_radius": 4
                },
                "preprocess_conf": {
                    "resize": 840
                },
                "dtype": "float32"
            },
            "keypoint_matching_args": {
                "matcher_params": {
                    "width_confidence": -1,
                    "depth_confidence": -1,
                    "mp": true
                },
                "min_matches": 30,
                "verbose": false
            }
        }
    },

    {
        "task": "matching",
        "comment": "aliked_LightGlue (imsize=1536)",
        "params": {
            "matcher": "LightGlue",
            "extractor": "aliked",
            "input": {
                "image_pair": "image_pair.csv"
            },
            "output": {
                "keypoints": "keypoints_orig.h5",
                "descriptions": "descriptions_orig.h5",
                "matches": "matches_orig.h5",
                "image_pair_csv": "image_pair.csv"
            },
            "sufficient_matching_num": 1024,
            "keypoint_detection_args": {
                "extractor_conf": {
                    "max_num_keypoints": 8192,
                    "detection_threshold": 0.01,
                    "nms_radius": 4
                },
                "preprocess_conf": {
                    "resize": 1536
                },
                "dtype": "float32"
            },
            "keypoint_matching_args": {
                "matcher_params": {
                    "width_confidence": -1,
                    "depth_confidence": -1,
                    "mp": true
                },
                "min_matches": 100,
                "verbose": false
            }
        }
    },
    {
        "task": "count_matching_num",
        "comment": "",
        "params": {
            "input": {
                "image_pair": "image_pair.csv",
                "matches": "matches_orig.h5"
            },
            "output": "image_pair.csv"
        }
    },

    {
        "task": "sfm_mkpc",
        "comment": "",
        "params": {
            "input": {
                "keypoints": "keypoints_orig.h5",
                "matches": "matches_orig.h5"
            },
            "output": "mkpc_rect.json",
            "thresh": 0.15,
            "db_scan_param": {
                "eps": 0.05,
                "min_samples": 16
            },
            "mkpt_rect_parms": {
                "crop_scale": [1.05, 1.05],
                "inliner_rate_thresh": 0.2
            }
        }
    },

    {
        "task": "matching",
        "comment": "LoFTR (imsize=1024)",
        "params": {
            "matcher": "LoFTR",
            "input": {
                "image_pair": "image_pair.csv",
                "rects": "mkpc_rect.json"
            },
            "output": {
                "keypoints": "keypoints_crop.h5",
                "matches": "matches_crop.h5"
            },
            "keypoint_matching_args": {
                "sample_thresh": 0.05,
                "img_size": [
                    1024,
                    1024
                ],
                "min_matches": 100
            }
        }
    },
    {
        "task": "concat",
        "comment": "",
        "params": {
            "input": {
                "keypoints": [
                    "keypoints_orig.h5",
                    "keypoints_crop.h5"
                ],
                "matches": [
                    "matches_orig.h5",
                    "matches_crop.h5"
                ]
            },
            "output": {
                "keypoints": "keypoints.h5",
                "matches": "matches.h5"
            }
        }
    },
    {
        "task": "rem_less_match_pair",
        "comment": "",
        "params": {
            "input": "matches.h5",
            "output": "matches.h5",
            "th_matching_num": 300
        }
    },
    {
        "task": "count_matching_num",
        "comment": "",
        "params": {
            "input": {
                "image_pair": "image_pair.csv",
                "matches": "matches.h5"
            },
            "output": "image_pair.csv"
        }
    }
]